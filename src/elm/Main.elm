module Main exposing (..)

import Animation exposing (px)
import Html exposing (Html, div)
import Html.Lazy exposing (lazy)
import Svg exposing (..)
import Svg.Attributes exposing (..)
import Task
import Time exposing (second)


type alias Model =
  { style : Animation.State
  }


type Msg
  = Animate Animation.Msg
  | StartAnimation


cloud : List Animation.Property
cloud =
  [ Animation.translate (px -60) (px 5)
  ]


update : Msg -> Model -> ( Model, Cmd Msg )
update action model =
  case action of
    StartAnimation ->
      let
          newStyle : Animation.State
          newStyle =
              Animation.interrupt
                [ Animation.loop
                  [ Animation.toWith
                    ( Animation.easing
                      { duration = 4 * second
                      , ease = (\t -> sin (t * pi / 2) ^ 2)
                      }
                    )
                    [ Animation.translate (px 60) (px 0)
                    ]
                  , Animation.toWith
                    ( Animation.easing
                      { duration = 4 * second
                      , ease = (\t -> sin (t * pi / 2) ^ 2)
                      }
                    )
                    [ Animation.translate (px -60) (px 0)
                    ]
                  ]
                ]
                model.style
      in
        ( { model
          | style = newStyle
          }
        , Cmd.none
        )

    Animate time ->
      ( { model
        | style = Animation.update time model.style
        }
      , Cmd.none
      )


view : Model -> Html Msg
view model =
  div
    []
    [ svg
      [ viewBox "0 0 2560 1920"
      ]
      [ linearGradient
        [ id "a"
        , gradientUnits "userSpaceOnUse"
        , x1 "1508.627196"
        , x2 "1548.347976"
        , y1 "-300.403324"
        , y2 "669.867002"
        ]
        [ stop
          [ offset "0"
          , stopColor "#ffe8aa"
          ]
          []
        , stop
          [ offset "1"
          , stopColor "#ffe8aa"
          , stopOpacity "0"
          ]
          []
        ]
      , linearGradient
        [ id "b"
        , gradientTransform "matrix(2.5864 0 0 2.7392 1086.6 -1425.4)"
        , gradientUnits "userSpaceOnUse"
        , x1 "252.44"
        , x2 "251.02"
        , y1 "39.472"
        , y2 "236.76"
        ]
        [ stop
          [ offset "0"
          , stopColor "#ffe2aa"
          ]
          []
        , stop
          [ offset "1"
          , stopColor "#ffe2aa"
          , stopOpacity "0"
          ]
          []
        ]
      , g
        [ transform "translate(0 1440)"
        ]
        [ Svg.path
          [ d "m .3055-1454.1v1932.1h1121.3c336.78-215.81 559.73-591.32 559.73-1018.6 0-364.54-162.35-691.43-419.2-913.59h-1261.9z"
          , fill "#ff70a8"
          , fillOpacity ".65"
          ]
          []
        , Svg.path
          [ d "m283.55 296.46a5.264.35093 0 1 1 -10.528 0 5.264.35093 0 1 1 10.528 0z"
          , Svg.Attributes.style "fill:#fca;fillOpacity:.65;stroke:#e2e6d5;strokeLinecap:round;strokeLinejoin:round;strokeWidth:.2"
          , transform "matrix(4.0122 0 0 4.0122 842.3 -1000.5)"
          ]
          []
        , lazy renderCloud1 model.style
        , lazy renderCloud2 model.style
        ]
      , g
        [ transform "translate(0 1440)"
        ]
        [ g
          [ transform "matrix(4.1059 0 0 4.1059 -7.2803 -1452.5)"
          ]
          [ Svg.path
            [ d "m320.03 100.35c-10.662 1.6408-21.751 5.84-32.826 9.9596 0 0-12.767-2.7987-17.912.23183-5.8998 3.475-9.6136 11.012-10.191 17.835-1.0078 11.899 6.1159 23.428 12.289 33.65 10.248 16.969 33.802 25.212 39.942 44.06 3.1361 9.6265-3.2301 30.201-3.2301 30.201s-33.644-7.1503-45.72 2.1747c-53.139 41.034-113.49 112.42-135.77 119.22 1.9094 3.9196 34.766-2.8751 52.708-16.325 9.3794-7.0316-11.89 12.966-8.3046 12.981 9.1176.0399 20.046-18.089 25.915-19.076 7.1024-1.1952-18.268 19.364-8.9985 15.345 9.2414-4.0062 27.844-24.217 34.91-26.162 5.2163-1.436-17.45 19.847-12.832 17.892 11.015-4.6635 25.882-13.206 30.126-21.993 1.1746-2.4323-6.4329 11.606-8.594 16.037-1.4577 2.9892 17.08-18.441 19.918-19.498 4.9359-1.8389-8.7047 14.008-4.2699 11.784 6.7753-3.3977 15.069-18.535 20.304-22.309 7.5813-5.4664-10.187 16.995-5.2571 14.772 5.9021-2.661 15.642-19.632 20.603-22.143 5.1186-2.5906-6.7486 17.446-2.4904 14.318l11.875-14.92s37.07 17.852 57.082 18.826c8.392.40847 17.353-4.542 24.591-5.5329 18.857-2.5814 21.597 5.4346 31.848 2.5479 5.5596-1.5655 16.323-7.4992 18.968-15.146 2.4237-7.0088 3.0796-17.443-5.0957-21.657 0 0 8.8522-49.45 7.0386-51.626-3.9309-1.8952 60.274-4.2428 71.73-9.489 4.9215-2.2539-21.161-1.1864-23.799-2.7984-3.6808-2.2489 32.453-.0181 39.183-2.9629 2.5898-1.1334-35.843-3.5357-19.119-2.8899 2.6165.1011 35.078-9.0251 39.69-11.921-20.497 1.0182-21.786 3.097-22.922 1.0207 16.065-4.0294 25.725-16.194 28.987-17.478 10.34-4.0704-35.261 10.266-19.894 3.1956 14.848-6.8321 19.787-13.243 21.685-14.977 5.024-4.5914-26.912 12.112-18.516 5.4783 6.2539-4.9415 31.342-21.733 26.315-18.609-102.44 19.338-144.1-.20368-164.58 23.408-25.386 29.267-41.564 45.651-43.506 42.322 0 0-6.0871-17.079-11.465-24.205-13.014-17.242-13.91-12.157-48.719-42.735-5.7993-5.0945-7.489-18.941-7.489-18.941 7.2472-4.2539 8.8687-6.78 12.122-13.007 10.573-10.16 20.817-13.688 33.676-20.861z"
            , fill "#fff"
            , stroke "#e2e6d5"
            , strokeWidth "1.089"
            ]
            []
          , Svg.path
            [ d "m371.22 313.14c3.5669 10.43-3.3456 16.368-7.6568 23.421 7.3566-.84719 14.713-3.6902 22.07-11.71-3.2052 11.463-1.8601 18.375.90081 23.871 5.9595.11181 8.9015-10.71 13.512-19.367 9.3699 7.5067 7.3803 15.013 10.359 22.52 3.7346-7.2002 7.8486-13.515 8.1072-28.826 11.607 3.7555 16.164 11.741 22.07 18.917 1.0012-10.755 2.9636-21.413-7.6568-33.33 8.3025.71292 15.715 3.6503 21.619 10.359 3.6429-6.5405-1.7335-15.541-11.26-25.673 8.1503-1.4839 10.246.18845 12.161-.90082-4.4257-15.786-19.507-16.554-34.658-15.655 0 0 5.9003 15.977 3.1302 23.312-2.6697 7.0688-6.0827 14.346-17.115 14.863-12.961.60717-27.133-8.5418-35.582-1.8016z"
            , stroke "#000"
            , strokeWidth "1.8151"
            ]
            []
          , Svg.path
            [ d "m-123.62 147.01c0 .31495-.19639.57027-.43866.57027s-.43867-.25532-.43867-.57027.1964-.57027.43867-.57027.43866.25532.43866.57027z"
            , stroke "#ffe6d5"
            , strokeLinecap "round"
            , strokeOpacity ".83"
            , strokeWidth ".3"
            , transform "matrix(5.2757 0 0 3.5904 934.04 -408.7)"
            ]
            []
          , Svg.path
            [ d "m261.67 117.92s2.8638-6.2339 8.3602-8.7583c4.9437-2.2705 17.158.63696 17.158.63696s-8.5209 5.5827-13.336 7.0066c-3.9103 1.1562-12.182 1.1147-12.182 1.1147z"
            , fill "#df0000"
            ]
            []
          , Svg.path
            [ d "m287.23 110.28l-.79622 10.789c9.6603-7.9741 22.018-14.538 34.635-21.139-5.5588.74794-21.401 5.1155-33.839 10.351z"
            , fill "#fc0"
            , stroke "#540"
            , strokeLinecap "round"
            , strokeLinejoin "round"
            , strokeWidth ".72602"
            ]
            []
          , Svg.path
            [ d "m286.71 118.48c10.542-7.7091 21.591-13.22 32.764-18.193"
            , fill "none"
            , stroke "#540"
            , strokeLinecap "round"
            , strokeLinejoin "round"
            , strokeWidth ".36301"
            ]
            []
          , Svg.path
            [ d "m274.16 134.33c-8.6803 1.9654-8.5776-2.8616-10.157-6.559 0 0 1.8335 25.271 13.689 38.287 11.152 12.243 25.064 22.621 32.95 37.184 1.4974 2.7653 2.4932 9.0986 2.4932 9.0986 8.8347-19.341 19.83-2.5841 27.909 7.1159 1.0818 0-7.7594-23.893-19.593-33.555-12.476-10.186-19.976-16.259-35.582-29.501-8.0414-6.8238-12.866-21.531-11.71-22.07z"
            , stroke "#000"
            , strokeWidth ".36301"
            ]
            []
          ]
        , g
          [ transform "matrix(0 1.4991 1.4991 0 1876.2 -500.27)"
          ]
          [ Svg.path
            [ d "m320.03 100.35c-10.662 1.6408-21.751 5.84-32.826 9.9596 0 0-12.767-2.7987-17.912.23183-5.8998 3.475-9.6136 11.012-10.191 17.835-1.0078 11.899 6.1159 23.428 12.289 33.65 10.248 16.969 33.802 25.212 39.942 44.06 3.1361 9.6265-3.2301 30.201-3.2301 30.201s-33.644-7.1503-45.72 2.1747c-53.139 41.034-113.49 112.42-135.77 119.22 1.9094 3.9196 34.766-2.8751 52.708-16.325 9.3794-7.0316-11.89 12.966-8.3046 12.981 9.1176.0399 20.046-18.089 25.915-19.076 7.1024-1.1952-18.268 19.364-8.9985 15.345 9.2414-4.0062 27.844-24.217 34.91-26.162 5.2163-1.436-17.45 19.847-12.832 17.892 11.015-4.6635 25.882-13.206 30.126-21.993 1.1746-2.4323-6.4329 11.606-8.594 16.037-1.4577 2.9892 17.08-18.441 19.918-19.498 4.9359-1.8389-8.7047 14.008-4.2699 11.784 6.7753-3.3977 15.069-18.535 20.304-22.309 7.5813-5.4664-10.187 16.995-5.2571 14.772 5.9021-2.661 15.642-19.632 20.603-22.143 5.1186-2.5906-6.7486 17.446-2.4904 14.318l11.875-14.92s37.07 17.852 57.082 18.826c8.392.40847 17.353-4.542 24.591-5.5329 18.857-2.5814 21.597 5.4346 31.848 2.5479 5.5596-1.5655 16.323-7.4992 18.968-15.146 2.4237-7.0088 3.0796-17.443-5.0957-21.657 0 0 8.8522-49.45 7.0386-51.626-3.9309-1.8952 60.274-4.2428 71.73-9.489 4.9215-2.2539-21.161-1.1864-23.799-2.7984-3.6808-2.2489 32.453-.0181 39.183-2.9629 2.5898-1.1334-35.843-3.5357-19.119-2.8899 2.6165.1011 35.078-9.0251 39.69-11.921-20.497 1.0182-21.786 3.097-22.922 1.0207 16.065-4.0294 25.725-16.194 28.987-17.478 10.34-4.0704-35.261 10.266-19.894 3.1956 14.848-6.8321 19.787-13.243 21.685-14.977 5.024-4.5914-26.912 12.112-18.516 5.4783 6.2539-4.9415 31.342-21.733 26.315-18.609-102.44 19.338-144.1-.20368-164.58 23.408-25.386 29.267-41.564 45.651-43.506 42.322 0 0-6.0871-17.079-11.465-24.205-13.014-17.242-13.91-12.157-48.719-42.735-5.7993-5.0945-7.489-18.941-7.489-18.941 7.2472-4.2539 8.8687-6.78 12.122-13.007 10.573-10.16 20.817-13.688 33.676-20.861z"
            , fill "#fff"
            , stroke "#e2e6d5"
            , strokeWidth "1.089"
            ]
            []
          , Svg.path
            [ d "m371.22 313.14c3.5669 10.43-3.3456 16.368-7.6568 23.421 7.3566-.84719 14.713-3.6902 22.07-11.71-3.2052 11.463-1.8601 18.375.90081 23.871 5.9595.11181 8.9015-10.71 13.512-19.367 9.3699 7.5067 7.3803 15.013 10.359 22.52 3.7346-7.2002 7.8486-13.515 8.1072-28.826 11.607 3.7555 16.164 11.741 22.07 18.917 1.0012-10.755 2.9636-21.413-7.6568-33.33 8.3025.71292 15.715 3.6503 21.619 10.359 3.6429-6.5405-1.7335-15.541-11.26-25.673 8.1503-1.4839 10.246.18845 12.161-.90082-4.4257-15.786-19.507-16.554-34.658-15.655 0 0 5.9003 15.977 3.1302 23.312-2.6697 7.0688-6.0827 14.346-17.115 14.863-12.961.60717-27.133-8.5418-35.582-1.8016z"
            , stroke "#000"
            , strokeWidth "1.8151"
            ]
            []
          , Svg.path
            [ d "m-123.62 147.01c0 .31495-.19639.57027-.43866.57027s-.43867-.25532-.43867-.57027.1964-.57027.43867-.57027.43866.25532.43866.57027z"
            , stroke "#ffe6d5"
            , strokeLinecap "round"
            , strokeOpacity ".83"
            , strokeWidth ".3"
            , transform "matrix(5.2757 0 0 3.5904 934.04 -408.7)"
            ]
            []
          , Svg.path
            [ d "m261.67 117.92s2.8638-6.2339 8.3602-8.7583c4.9437-2.2705 17.158.63696 17.158.63696s-8.5209 5.5827-13.336 7.0066c-3.9103 1.1562-12.182 1.1147-12.182 1.1147z"
            , fill "#df0000"
            ]
            []
          , Svg.path
            [ d "m287.23 110.28l-.79622 10.789c9.6603-7.9741 22.018-14.538 34.635-21.139-5.5588.74794-21.401 5.1155-33.839 10.351z"
            , fill "#fc0"
            , stroke "#540"
            , strokeLinecap "round"
            , strokeLinejoin "round"
            , strokeWidth ".72602"
            ]
            []
          , Svg.path
            [ d "m286.71 118.48c10.542-7.7091 21.591-13.22 32.764-18.193"
            , fill "none"
            , stroke "#540"
            , strokeLinecap "round"
            , strokeLinejoin "round"
            , strokeWidth ".36301"
            ]
            []
          , Svg.path
            [ d "m274.16 134.33c-8.6803 1.9654-8.5776-2.8616-10.157-6.559 0 0 1.8335 25.271 13.689 38.287 11.152 12.243 25.064 22.621 32.95 37.184 1.4974 2.7653 2.4932 9.0986 2.4932 9.0986 8.8347-19.341 19.83-2.5841 27.909 7.1159 1.0818 0-7.7594-23.893-19.593-33.555-12.476-10.186-19.976-16.259-35.582-29.501-8.0414-6.8238-12.866-21.531-11.71-22.07z"
            , stroke "#000"
            , strokeWidth ".36301"
            ]
            []
          ]
        , g
          [ transform "matrix(.70546 -.38458 .38458 .70546 1591 204.06)"
          ]
          [ Svg.path
            [ d "m320.03 100.35c-10.662 1.6408-21.751 5.84-32.826 9.9596 0 0-12.767-2.7987-17.912.23183-5.8998 3.475-9.6136 11.012-10.191 17.835-1.0078 11.899 6.1159 23.428 12.289 33.65 10.248 16.969 33.802 25.212 39.942 44.06 3.1361 9.6265-3.2301 30.201-3.2301 30.201s-33.644-7.1503-45.72 2.1747c-53.139 41.034-113.49 112.42-135.77 119.22 1.9094 3.9196 34.766-2.8751 52.708-16.325 9.3794-7.0316-11.89 12.966-8.3046 12.981 9.1176.0399 20.046-18.089 25.915-19.076 7.1024-1.1952-18.268 19.364-8.9985 15.345 9.2414-4.0062 27.844-24.217 34.91-26.162 5.2163-1.436-17.45 19.847-12.832 17.892 11.015-4.6635 25.882-13.206 30.126-21.993 1.1746-2.4323-6.4329 11.606-8.594 16.037-1.4577 2.9892 17.08-18.441 19.918-19.498 4.9359-1.8389-8.7047 14.008-4.2699 11.784 6.7753-3.3977 15.069-18.535 20.304-22.309 7.5813-5.4664-10.187 16.995-5.2571 14.772 5.9021-2.661 15.642-19.632 20.603-22.143 5.1186-2.5906-6.7486 17.446-2.4904 14.318l11.875-14.92s37.07 17.852 57.082 18.826c8.392.40847 17.353-4.542 24.591-5.5329 18.857-2.5814 21.597 5.4346 31.848 2.5479 5.5596-1.5655 16.323-7.4992 18.968-15.146 2.4237-7.0088 3.0796-17.443-5.0957-21.657 0 0 8.8522-49.45 7.0386-51.626-3.9309-1.8952 60.274-4.2428 71.73-9.489 4.9215-2.2539-21.161-1.1864-23.799-2.7984-3.6808-2.2489 32.453-.0181 39.183-2.9629 2.5898-1.1334-35.843-3.5357-19.119-2.8899 2.6165.1011 35.078-9.0251 39.69-11.921-20.497 1.0182-21.786 3.097-22.922 1.0207 16.065-4.0294 25.725-16.194 28.987-17.478 10.34-4.0704-35.261 10.266-19.894 3.1956 14.848-6.8321 19.787-13.243 21.685-14.977 5.024-4.5914-26.912 12.112-18.516 5.4783 6.2539-4.9415 31.342-21.733 26.315-18.609-102.44 19.338-144.1-.20368-164.58 23.408-25.386 29.267-41.564 45.651-43.506 42.322 0 0-6.0871-17.079-11.465-24.205-13.014-17.242-13.91-12.157-48.719-42.735-5.7993-5.0945-7.489-18.941-7.489-18.941 7.2472-4.2539 8.8687-6.78 12.122-13.007 10.573-10.16 20.817-13.688 33.676-20.861z"
            , fill "#fff"
            , stroke "#e2e6d5"
            , strokeWidth "1.089"
            ]
            []
          , Svg.path
            [ d "m371.22 313.14c3.5669 10.43-3.3456 16.368-7.6568 23.421 7.3566-.84719 14.713-3.6902 22.07-11.71-3.2052 11.463-1.8601 18.375.90081 23.871 5.9595.11181 8.9015-10.71 13.512-19.367 9.3699 7.5067 7.3803 15.013 10.359 22.52 3.7346-7.2002 7.8486-13.515 8.1072-28.826 11.607 3.7555 16.164 11.741 22.07 18.917 1.0012-10.755 2.9636-21.413-7.6568-33.33 8.3025.71292 15.715 3.6503 21.619 10.359 3.6429-6.5405-1.7335-15.541-11.26-25.673 8.1503-1.4839 10.246.18845 12.161-.90082-4.4257-15.786-19.507-16.554-34.658-15.655 0 0 5.9003 15.977 3.1302 23.312-2.6697 7.0688-6.0827 14.346-17.115 14.863-12.961.60717-27.133-8.5418-35.582-1.8016z"
            , stroke "#000"
            , strokeWidth "1.8151"
            ]
            []
          , Svg.path
            [ d "m-123.62 147.01a.43867.57027 0 1 1 -.87733 0 .43867.57027 0 1 1 .87733 0z"
            , stroke "#ffe6d5"
            , strokeLinecap "round"
            , strokeOpacity ".83"
            , strokeWidth ".3"
            , transform "matrix(5.2757 0 0 3.5904 934.04 -408.7)"
            ]
            []
          , Svg.path
            [ d "m261.67 117.92s2.8638-6.2339 8.3602-8.7583c4.9437-2.2705 17.158.63696 17.158.63696s-8.5209 5.5827-13.336 7.0066c-3.9103 1.1562-12.182 1.1147-12.182 1.1147z"
            , fill "#df0000"
            ]
            []
          , Svg.path
            [ d "m287.23 110.28l-.79622 10.789c9.6603-7.9741 22.018-14.538 34.635-21.139-5.5588.74794-21.401 5.1155-33.839 10.351z"
            , fill "#fc0"
            , stroke "#540"
            , strokeLinecap "round"
            , strokeLinejoin "round"
            , strokeWidth ".72602"
            ]
            []
          , Svg.path
            [ d "m286.71 118.48c10.542-7.7091 21.591-13.22 32.764-18.193"
            , fill "none"
            , stroke "#540"
            , strokeLinecap "round"
            , strokeLinejoin "round"
            , strokeWidth ".36301"
            ]
            []
          , Svg.path
            [ d "m274.16 134.33c-8.6803 1.9654-8.5776-2.8616-10.157-6.559 0 0 1.8335 25.271 13.689 38.287 11.152 12.243 25.064 22.621 32.95 37.184 1.4974 2.7653 2.4932 9.0986 2.4932 9.0986 8.8347-19.341 19.83-2.5841 27.909 7.1159 1.0818 0-7.7594-23.893-19.593-33.555-12.476-10.186-19.976-16.259-35.582-29.501-8.0414-6.8238-12.866-21.531-11.71-22.07z"
            , stroke "#000"
            , strokeWidth ".36301"
            ]
            []
          ]
        ]
      ]
    ]

renderCloud1 : Animation.State -> Html Msg
renderCloud1 style =
  Svg.path
    ( List.concat
      [ Animation.render style
      ,  [ d "m1235.4-1288.2c-69.269 0-125.01 41.292-125.01 92.608 0 51.315 55.739 92.608 125.01 92.608h189.65c-16.979 19.324-26.795 42.4-26.795 67.274 0 68.259 74.154 123.19 166.29 123.19h738.37c92.14 0 166.29-54.934 166.29-123.19 0-68.259-74.154-123.19-166.29-123.19h-131.58c6.5073-11.233 10.113-23.649 10.113-36.688 0-51.315-55.739-92.608-125.01-92.608h-821.05z"
        , fill "url(#b)"
        ]
      ]
    )
    []


renderCloud2 : Animation.State -> Html Msg
renderCloud2 style =
  Svg.path
    ( List.concat
      [ Animation.render style
      , [ d "m667.46-283.35c-110.81 0-199.98 68.796-199.98 154.34 0 31.174 11.804 60.037 32.223 84.256h-228.07c-83.302 0-150.33 51.79-150.33 116.1 0 64.313 67.031 116.1 150.33 116.1h187.44c-24.582 23.007-39.871 55.799-39.871 92.281 0 69.942 56.317 126.26 126.26 126.26h1480.9c69.942 0 126.26-56.317 126.26-126.26 0-69.942-56.317-126.26-126.26-126.26h-661.01c27.17-20.977 44.009-49.968 44.009-82.125 0-16.341-4.3364-31.936-12.162-46.015h158.23c110.81 0 199.98-68.796 199.98-154.34 0-85.548-89.176-154.34-199.98-154.34h-887.95z"
        , fill "url(#a)"
        ]
      ]
    )
    []


init : ( Model, Cmd Msg )
init =
  ( { style = Animation.style cloud
    }
  , Task.perform (always StartAnimation) (Task.succeed ())
  )


main : Program Never Model Msg
main =
  Html.program
    { init = init
    , view = view
    , update = update
    , subscriptions =
      (\model ->
        Animation.subscription
          Animate
          [ model.style ]
      )
    }
